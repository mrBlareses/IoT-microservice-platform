# IoT Microservice Platform

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–î–∏–∞–≥—Ä–∞–º–º—ã C4](#–¥–∏–∞–≥—Ä–∞–º–º—ã-c4)
- [–°–æ—Å—Ç–∞–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å–æ—Å—Ç–∞–≤-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Makefile)](#—Ä—É—á–Ω–æ–π-–∑–∞–ø—É—Å–∫-–±–µ–∑-makefile)
- [–ü–æ—Ä—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã](#–ø–æ—Ä—Ç—ã-–∏-—Å–µ—Ä–≤–∏—Å—ã)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (ENV)](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-env)
- [–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å](#–Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å)
- [–¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ](#—Ç–∏–ø–æ–≤—ã–µ-–æ—à–∏–±–∫–∏-–∏-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–∫–∞—Ç–∞–ª–æ–≥–æ–≤)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É IoT-—Å–∏—Å—Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.  
–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- PostgreSQL (—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π)
- Redis (–∫—ç—à –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- Cassandra (–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö NoSQL)
- Kafka + Zookeeper (—à–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π)
- MinIO (–æ–±—ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- Keycloak (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
- Camunda (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
- Prometheus, Grafana, Loki, Tempo (–Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- Schema registry (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–∞–º–∏ –¥–ª—è Kafka)

---

## –î–∏–∞–≥—Ä–∞–º–º—ã C4

### [–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞](diagrams/context.puml) 
- –û–ø–∏—Å–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–∏—Å—Ç–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –æ–±–∑–æ—Ä

### [–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞](diagrams/containers.puml)
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (—Å–µ—Ä–≤–∏—Å–æ–≤) –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

> üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∏–∞–≥—Ä–∞–º–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [PlantUML](https://plantuml.com/) –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–≥–∏–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è .puml —Ñ–∞–π–ª–æ–≤ –≤ –≤–∞—à–µ–π IDE.
---

## –°–æ—Å—Ç–∞–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- `infrastructure/` ‚Äî docker-compose –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–ë–î, –±—Ä–æ–∫–µ—Ä—ã, observability).
- `Makefile` ‚Äî —É–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- `README.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –∫–æ–º–∞–Ω–¥–∞–º
make help

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make up

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (—Å —Ñ–ª–∞–≥–æ–º -f –¥–ª—è —Å–ª–µ–∂–µ–Ω–∏—è)
make logs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
make ps

# –û—á–∏—Å—Ç–∫–∞ Kafka –∫–ª–∞—Å—Ç–µ—Ä–∞
make clean-kafka-cluster

```

–¢—Ä–µ–±—É–µ—Ç—Å—è: Docker (compose), JDK 24, make.

---

## –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Makefile)

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞–ø—Ä—è–º—É—é
docker compose -f docker-compose.yml --env-file .env up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose -f docker-compose.yml --env-file .env down
```

---

## –ü–æ—Ä—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å            | –ü–æ—Ä—Ç (host) | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
|-------------------|-------------|----------------------------------------------|
| Keycloak          | 8080        | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è                   |
| Prometheus        | 9090        | –ú–µ—Ç—Ä–∏–∫–∏                                      |
| Grafana           | 3000        | Dashboard + Explore                          |
| Tempo             | 3200        | –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ–∫ (OTLP)                 |
| Loki              | 3100        | –•—Ä–∞–Ω–∏–ª–∏—â–µ –ª–æ–≥–æ–≤                              |
| Postgres          | 5432        | –û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö                         |
| Postgres Exporter | 9187        | –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä –º–µ—Ç—Ä–∏–∫ PostgreSQL –¥–ª—è Prometheus   |   
| MinIO API         | 9000        | API –¥–ª—è –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞                 |   
| MinIO Console     | 9001        | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è MinIO           |   
| Cassandra         | 9042        | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö NoSQL                            |   
| Redis             | 6379        | –ö—ç—à –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ                |   
| Schema registry   | 8081        | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–∞–º–∏ –¥–ª—è Kafka                 |   
| Zookeeper         | 2181        | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –¥–ª—è Kafka                        |   
| Kafka1            | 9092        | –ë—Ä–æ–∫–µ—Ä Kafka 1                               |   
| Kafka2            | 9093        | –ë—Ä–æ–∫–µ—Ä Kafka 2                               |   
| Kafka3            | 9094        | –ë—Ä–æ–∫–µ—Ä Kafka 3                               |   
---

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

- Prometheus: [http://localhost:9090](http://localhost:9090)  
- Grafana: [http://localhost:3000](http://localhost:3000)  
- Loki: [http://localhost:3100](http://localhost:3100)  
- Tempo: [http://localhost:3200](http://localhost:3200)

---

## –¢–∏–ø–æ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

- **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—Ç–∞–º–∏** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç—ã –Ω–µ –∑–∞–Ω—è—Ç—ã –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.  
- **Keycloak –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç** ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Postgres –ø–æ–¥–Ω—è—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω.  
- **Grafana –ø—É—Å—Ç–∞—è** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ data source –Ω–∞ Prometheus.
- **–ù–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç Kafka –∫–ª–∞—Å—Ç–µ—Ä** - –æ—á–∏—Å—Ç–∏—Ç–µ Kafka –∫–ª–∞—Å—Ç–µ—Ä  

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤

```
iot-platform/
‚îú‚îÄ‚îÄ diagrams/                     # C4-–¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ containers.puml
‚îÇ   ‚îî‚îÄ‚îÄ context.puml
‚îú‚îÄ‚îÄ infrastructure/               # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Docker
‚îÇ   ‚îú‚îÄ‚îÄ monitoring/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄgrafana
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄgrafana.db         # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Grafana (DataSource, Dashboards, Panels) 
‚îÇ   ‚îú‚îÄ‚îÄ prometheus/prometheus.yml
‚îÇ   ‚îú‚îÄ‚îÄ loki/loki-config.yaml
‚îÇ   ‚îú‚îÄ‚îÄ tempo/tempo-config.yaml
‚îÇ   ‚îî‚îÄ‚îÄ grafana/{dashboards,provisioning}
‚îú‚îÄ‚îÄ docker-compose.yaml           # Docker Compose –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ .env                          # –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–≤ .gitignore)
‚îú‚îÄ‚îÄ README.md                     # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ Makefile                      # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```
